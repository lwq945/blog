## 同源策略
同源策略是Web应用安全模型中的一个重要概念。根据该策略， Web浏览器允许包含在第一网页中的脚本访问第二网页中的数据，但是只有当两个网页具有**相同的源**才允许。此策略可防止一个页面上的恶意脚本通过该页面的文档对象模型获取对另一个网页上敏感数据的访问。

**同源(同域)**
两个URL同协议，同域名（ip），同端口，。
## 跨域的几种实现形式
跨域：浏览器上当前访问的网站向另一个网站发送请求获取数据的过程。

跨域实现形式：
- JSONP
- CORS
- 降域
- postMessage
## JSONP的原理
html中script标签可以引入其他域下的js加载并执行，比如引入线上的jquery库。利用这个特性，可以通过script标记来动态加载其他域的资源实现跨域访问接口。
- 定义数据处理函数showData()
- 创建script标签，src的地址是执行后端接口，最后加个参数callback=showData。

例如：<script src="http://api.jirengu.com/weathe.phpr?callback=showData"></script>
- 服务端在收到请求后，通过query.callback得到回调函数的名称，解析参数，计算返还数据，把返回数据当做回调函数的参数，输出 showData(data) 字符串。
- showData(data)会放到script标签做为js执行。此时会调用 showData 函数，将data做为参数。
```
//前端页面
<body>
  <div class="container">
      <ul class="news">
        <li>new8</li>
      </ul>
      <button class="change">换一组</button>
  </div>
  
  <script>
   var btn = document.querySelector(".change");
   var news1 = document.querySelector('.news');
   btn.addEventListener('click',function(){
     var script = document.createElement('script');
     script.src = 'http://lwq.test.com:8080/getnews?callback=appendHtml';
     document.head.appendChild(script);
     document.head.removeChild(script);
   });
   function appendHtml(news){
     var html = '';
     for(var i=0;i<news.length;i++){
        html+='<li>'+ news[i] + '</li>';
     }
     //console.log(html);
     news1.innerHTML = html;
   }
 </script>
</body>

//后端router.js
app.get('/getnews', function(req, res){
	var news = [
		"new1",
		"new2",
		"new3",
		"new4",
		"new5",
		"new6",
		"new7",
	];
	var data = [];
	for(var i=0; i<3; i++){
		var index = parseInt(Math.random()*news.length);
		data.push(news[index]);
	}
	var cb = req.query.callback;
	if(cb){
		res.send(cb + '('+ JSON.stringify(data) + ')');
	}else{
		res.send(data);
	}
});
```
